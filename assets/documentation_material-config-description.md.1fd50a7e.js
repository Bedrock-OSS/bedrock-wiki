import{_ as o,c as p,a as s,w as e,e as n,r,o as l,d as t}from"./404.md.4e630b9f.js";const S='{"title":"Material Configuration Description","description":"","frontmatter":{"title":"Material Configuration Description","tags":["expert"]},"headers":[{"level":2,"title":"Foreword","slug":"foreword"},{"level":2,"title":"Material files","slug":"material-files"},{"level":2,"title":"Material syntax","slug":"material-syntax"},{"level":2,"title":"Overview of all property fields of the material","slug":"overview-of-all-property-fields-of-the-material"},{"level":3,"title":"Render state","slug":"render-state"},{"level":3,"title":"Shader path","slug":"shader-path"},{"level":3,"title":"Shader macro definition","slug":"shader-macro-definition"},{"level":3,"title":"Runtime state","slug":"runtime-state"},{"level":3,"title":"Material variant","slug":"material-variant"},{"level":2,"title":"Material Merge Rules","slug":"material-merge-rules"}],"relativePath":"documentation/material-config-description.md"}',i={},c=n('<div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Materials are not for the faint of heart. Be prepared for potential crashes, content log errors, and long loading times.</p></div><h2 id="foreword" tabindex="-1">Foreword <a class="header-anchor" href="#foreword" aria-hidden="true">#</a></h2><p>This article is translated from <a href="https://mc.163.com/dev/mcmanual/mc-dev/mcguide/" target="_blank" rel="noopener noreferrer">https://mc.163.com/dev/mcmanual/mc-dev/mcguide/</a> - It is provided by Netease, the developers of china edition. The article will introduce the structure and configuration of the material file in detail.</p><h2 id="material-files" tabindex="-1">Material files <a class="header-anchor" href="#material-files" aria-hidden="true">#</a></h2><p>We will explain the material files of native Microsoft. First of all, the files under the directory are basically files with the suffix &quot;.material&quot;. In addition, there are three important json files, namely common. json, fancy.json, sad.json.</p><p>Let&#39;s take a look at sad.json and fancy.json first. They are used to control the image quality performance. Each of them defines a list of material files. fancy.json usually defines several more material files than sad.json and may Some additional macros have been added to some material files, and the shader can do special processing by judging these macros:</p>',6),u=t("sad.json"),d=n(`<div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">[</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/sad.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/entity.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/terrain.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/portal.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/barrier.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/wireframe.material&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div>`,1),h=t("fancy.json"),k=n(`<div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">[</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/fancy.material&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;+defines&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;FANCY&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/entity.material&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;+defines&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;FANCY&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/terrain.material&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;+defines&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;FANCY&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/hologram.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/portal.material&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;+defines&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;FANCY&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/barrier.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/wireframe.material&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>It can be seen that fancy.json defines more fancy.material and hologram.material material files than sad.json, and also defines FANCY macros for multiple material files. The switch of in-game settings/video/exquisite texture is to control the switch between sad and fancy. When the fancy texture switch is turned on, the material file in fancy.json will take effect, and when it is turned off, the material file in sad.json will take effect.</p><p>In order to achieve better performance, the material files in fancy.json usually have more complex operations, while the materials in sad.json usually sacrifice a little rendering performance in exchange for better performance. If developers need to write more complex shaders, it is recommended to write a low-cost version at the same time, and then define them in fancy and sad respectively. Let the player control whether to turn on the corresponding effect through the exquisite texture option in the game.</p>`,3),m=t("common.json"),b=n(`<div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">[</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/particles.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/shadows.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/sky.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/ui.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/ui3D.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/portal.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/barrier.material&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span><span class="token property">&quot;path&quot;</span><span class="token operator">:</span><span class="token string">&quot;materials/wireframe.material&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Compared with sad and fancy, they can be switched between each other. The material files defined in common.json will be loaded after entering the game. Material files are not loaded except those declared in common.json, sad.json, fancy.json.</p><h2 id="material-syntax" tabindex="-1">Material syntax <a class="header-anchor" href="#material-syntax" aria-hidden="true">#</a></h2><p>We use one of the material files entity.material to explain, open the file, we can see that the file starts with materials, and then defines the version number version as 1.0.0, these are fixed formats, which identify the parsing of this material file way, we can temporarily ignore it and not modify it.</p><p>You can see that the definition of each field in the material is in the form of a key-value pair, for example:</p><div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">[</span>
	<span class="token property">&quot;vertexShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/entity.vertex&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>The left side of the colon represents the key as vertexShader, and the right side represents the value shaders/entity.vertex;</p><p>There are also definitions in list form:</p><div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">[</span>
	<span class="token property">&quot;vertexFields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Position&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Normal&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UV0&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>The declaration with the symbol [ ] is a list, and then inside is the json definition of each child element.</p><h2 id="overview-of-all-property-fields-of-the-material" tabindex="-1">Overview of all property fields of the material <a class="header-anchor" href="#overview-of-all-property-fields-of-the-material" aria-hidden="true">#</a></h2><h3 id="render-state" tabindex="-1">Render state <a class="header-anchor" href="#render-state" aria-hidden="true">#</a></h3><h4 id="states" tabindex="-1"><code>states</code> <a class="header-anchor" href="#states" aria-hidden="true">#</a></h4><p>Configure the rendering environment, which can have the following values:</p><ul><li><p><code>EnableAlphaToCoverage</code>\uFF1AAn order-independent rendering method for translucent objects. This switch is only useful in environments that support MSAA. When enabled, the edges of objects will be more accurately softened and transitioned according to the transparency. It can also be used for some complex scenes with a large number of meshes overlapping.</p></li><li><p><code>Wireframe</code>\uFF1A Draw wireframe mode</p></li><li><p><code>Blending</code>: Enables color blending mode, often used to render translucent objects. After declaring this, it is usually necessary to declare the blending factor blendSrc, blendDst</p></li><li><p><code>DisableColorWrite</code>\uFF1A Do not write color values to the color buffer, none of the RGBA channels are written</p></li><li><p><code>DisableAlphaWrite</code>\uFF1A Do not write transparency alpha values to the color buffer, allow RGB values to be written</p></li><li><p><code>DisableRGBWrite</code>\uFF1A Do not write transparency RGB values to the color buffer, allow writing alpha values</p></li><li><p><code>DisableDepthTest</code>\uFF1A Turn off depth testing</p></li><li><p><code>DisableDepthWrite</code>\uFF1A Turn off depth writing</p></li><li><p><code>DisableCulling</code>: Render front and back simultaneously</p></li><li><p><code>InvertCulling</code>\uFF1AUse front cropping. The default is back cropping. After declaring this, the back side is rendered and the front side is cropped.</p></li><li><p><code>StencilWrite</code>: Enable stencil mask writing</p></li><li><p><code>EnableStencilTest</code>\uFF1A Enable stencil mask testing</p></li></ul><h3 id="shader-path" tabindex="-1">Shader path <a class="header-anchor" href="#shader-path" aria-hidden="true">#</a></h3><h4 id="vertexshader" tabindex="-1"><code>vertexShader</code> <a class="header-anchor" href="#vertexshader" aria-hidden="true">#</a></h4><p>The path to the vertex shader, usually shaders/XXX.vertex.</p><h4 id="vrgeometryshader-or-geometryshader" tabindex="-1"><code>vrGeometryShader</code> or <code>geometryShader</code> <a class="header-anchor" href="#vrgeometryshader-or-geometryshader" aria-hidden="true">#</a></h4><p>The path of the geometry shader, usually shaders/XXX.geometry, is not used on the mobile side, and does not need to be modified.</p><h4 id="fragmentshader" tabindex="-1"><code>fragmentShader</code> <a class="header-anchor" href="#fragmentshader" aria-hidden="true">#</a></h4><p>The path to the fragment shader, usually shaders/XXX.fragment.</p><h3 id="shader-macro-definition" tabindex="-1">Shader macro definition <a class="header-anchor" href="#shader-macro-definition" aria-hidden="true">#</a></h3><h4 id="defines" tabindex="-1"><code>defines</code> <a class="header-anchor" href="#defines" aria-hidden="true">#</a></h4><p>Define macros for the shaders used. For code reuse, we use the same shader for many different materials. At this time, if you want to execute different logic somewhere in the shader according to the current material, you can judge it through the macro declared by the material defines. We can use the material entity_for_skeleton as an illustration. Here we can see that three macros USE_SKINNING, USE_OVERLAY, and NETEASE_SKINNING are defined.</p><div class="language-json line-numbers-mode"><pre><code><span class="token property">&quot;entity_for_skeleton&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;vertexShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/entity.vertex&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;vrGeometryShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/entity.geometry&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;fragmentShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/entity.fragment&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;+defines&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;USE_SKINNING&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;USE_OVERLAY&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;NETEASE_SKINNING&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token property">&quot;vertexFields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Position&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Normal&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BoneId0&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UV0&quot;</span> <span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token property">&quot;msaaSupport&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Both&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;+samplerStates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			<span class="token property">&quot;samplerIndex&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			<span class="token property">&quot;textureFilter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Point&quot;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Looking at the vertex shader entity.vertex, there will be #ifdef, #else, #endif to judge the macro and execute different logic branches. These judgment statements of the macro are processed at compile time, unlike the if in the traditional shader. Else, the logic branch processed at compile time will not be generated in actual operation, and the performance will not be degraded due to the branch. In addition, it can be seen below that macros can also make multi-layer judgments. First, judge the NETEASE_SKINNING macro, and then judge the LARGE_VERTEX_SHADER_UNIFORMS macro in the internal execution logic:</p><div class="language-glsl line-numbers-mode"><pre><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">NETEASE_SKINNING</span></span>
		MAT4 boneMat <span class="token operator">=</span> <span class="token function">transpose</span><span class="token punctuation">(</span><span class="token function">mat3x4ToMat4</span><span class="token punctuation">(</span>BONES_70<span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">(</span>BONEID_0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		entitySpacePosition <span class="token operator">=</span> boneMat <span class="token operator">*</span> POSITION<span class="token punctuation">;</span>
		entitySpaceNormal <span class="token operator">=</span> boneMat <span class="token operator">*</span> NORMAL<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>LARGE_VERTEX_SHADER_UNIFORMS<span class="token punctuation">)</span></span></span>
		entitySpacePosition <span class="token operator">=</span> BONES<span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">(</span>BONEID_0<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> POSITION<span class="token punctuation">;</span>
		entitySpaceNormal <span class="token operator">=</span> BONES<span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">(</span>BONEID_0<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> NORMAL<span class="token punctuation">;</span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
		entitySpacePosition <span class="token operator">=</span> BONE <span class="token operator">*</span> POSITION<span class="token punctuation">;</span>
		entitySpaceNormal <span class="token operator">=</span> BONE <span class="token operator">*</span> NORMAL<span class="token punctuation">;</span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="runtime-state" tabindex="-1">Runtime state <a class="header-anchor" href="#runtime-state" aria-hidden="true">#</a></h3><h4 id="depth-test" tabindex="-1">Depth test <a class="header-anchor" href="#depth-test" aria-hidden="true">#</a></h4><h5 id="depthfunc" tabindex="-1"><code>depthFunc</code> <a class="header-anchor" href="#depthfunc" aria-hidden="true">#</a></h5><p>The depth detection pass function can use the following values:</p><ul><li><p><code>Always</code>: Always pass</p></li><li><p><code>Equal</code>\uFF1A Passed when the depth value is equal to the buffer value</p></li><li><p><code>NotEqual</code>\uFF1APassed when the depth value is not equal to the buffer value</p></li><li><p><code>Less</code>\uFF1APassed when the depth value is less than the buffer value</p></li><li><p><code>Greater</code>\uFF1APassed when the depth value is greater than the buffer value</p></li><li><p><code>GreaterEqual</code>\uFF1APass when the depth value is greater than or equal to the buffer value</p></li><li><p><code>LessEqual</code>\uFF1APass when the depth value is less than or equal to the buffer value</p></li></ul><p>Associated states rendering environment configuration:</p><ul><li><p><code>DisableDepthTest</code>\uFF1A Turn off depth testing</p></li><li><p><code>DisableDepthWrite</code>\uFF1A Turn off depth writing</p></li></ul><h4 id="stencil-mask-test" tabindex="-1">Stencil Mask Test <a class="header-anchor" href="#stencil-mask-test" aria-hidden="true">#</a></h4><h5 id="stencilref" tabindex="-1"><code>stencilRef</code> <a class="header-anchor" href="#stencilref" aria-hidden="true">#</a></h5><p>Value to compare with or to be written to the mask buffer</p><h5 id="stencilrefoverride" tabindex="-1"><code>stencilRefOverride</code> <a class="header-anchor" href="#stencilrefoverride" aria-hidden="true">#</a></h5><p>Whether to use the buffer&#39;s current value as stencilRef, 0 or 1 is supported:</p><ul><li><p><code>1</code>\uFF1A Use the configured stencilRef. If stencilRef is configured, stencilRefOverride will automatically take 1</p></li><li><p><code>0</code>\uFF1A Use the current value of the buffer as stencilRef, in this case do not configure stencilRef</p></li></ul><h5 id="stencilreadmask" tabindex="-1"><code>stencilReadMask</code> <a class="header-anchor" href="#stencilreadmask" aria-hidden="true">#</a></h5><p>The mask buffer value and the stencilRef value are bit-ANDed with stencilReadMask before being compared</p><h5 id="stencilwritemask" tabindex="-1"><code>stencilWriteMask</code> <a class="header-anchor" href="#stencilwritemask" aria-hidden="true">#</a></h5><p>The stencilRef value is bit-ANDed with stencilWriteMask before being written to the mask buffer</p><h5 id="frontface-and-backface" tabindex="-1"><code>frontFace</code> and <code>backFace</code> <a class="header-anchor" href="#frontface-and-backface" aria-hidden="true">#</a></h5><p>Configure which mask test function to use on the front or back of the grid. In addition, the order of judgment is mask detection first, then depth detection. You need to configure the following operations:</p><ul><li><p><code>stencilFunc</code>: The method used when stencilRef is compared with the mask buffer, the following values are supported\uFF1A</p><ul><li><code>Always</code>: Always pass</li><li><code>Equal</code>\uFF1A Passed when stencilRef is equal to the buffer value</li><li><code>NotEqual</code> \uFF1APassed when stencilRef is not equal to the buffer value</li><li><code>Less</code>\uFF1APassed when stencilRef is less than the buffer value</li><li><code>Greater</code>\uFF1APassed when stencilRef is greater than the buffer value</li><li><code>GreaterEqual</code>\uFF1APassed when stencilRef is greater than or equal to the buffer value</li><li><code>LessEqual</code>\uFF1APassed when stencilRef is less than or equal to the buffer value</li></ul></li><li><p><code>stencilFailOp</code>\uFF1AThe processing performed when the stencilFunc comparison function fails to return, supports the following values\uFF1A</p><ul><li><code>Keep</code>\uFF1A Keep the original value of the buffer</li><li><code>Replace</code>\uFF1A Writes the stencilRef bit and the value of stencilWriteMask to the buffer</li></ul></li><li><p><code>stencilDepthFailOp</code> : The stencilFunc comparison function returns success, but the processing performed when the depth test fails, supports the following values\uFF1A</p><ul><li><code>Keep</code>\uFF1A Keep the original value of the buffer</li><li><code>Replace</code>\uFF1A Writes the stencilRef bit and the value of stencilWriteMask to the buffer</li></ul></li><li><p><code>stencilPassOp</code>: The stencilFunc comparison function returns successfully, and the processing executed when the depth test is successful, supports the following values\uFF1A</p><ul><li><code>Keep</code>\uFF1A Keep the original value of the buffer</li><li><code>Replace</code>\uFF1A Writes the stencilRef bit and the value of stencilWriteMask to the buffer</li></ul></li></ul><p>Associated states rendering environment configuration:</p><ul><li><p><code>StencilWrite</code>\uFF1AEnable mask writing</p></li><li><p><code>EnableStencilTest</code>: Enable mask testing</p></li></ul><p>Finally, let&#39;s look at an example:</p><div class="language-json line-numbers-mode"><pre><code>    <span class="token property">&quot;shadow_back&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;+states&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;StencilWrite&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;DisableColorWrite&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;DisableDepthWrite&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;InvertCulling&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;EnableStencilTest&quot;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>

      <span class="token property">&quot;vertexShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/position.vertex&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;vrGeometryShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/position.geometry&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fragmentShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/flat_white.fragment&quot;</span><span class="token punctuation">,</span>

      <span class="token property">&quot;frontFace&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;stencilFunc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Always&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;stencilFailOp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Keep&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;stencilDepthFailOp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Keep&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;stencilPassOp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Replace&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token property">&quot;backFace&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;stencilFunc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Always&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;stencilFailOp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Keep&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;stencilDepthFailOp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Keep&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;stencilPassOp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Replace&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token property">&quot;stencilRef&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;stencilReadMask&quot;</span><span class="token operator">:</span> <span class="token number">255</span><span class="token punctuation">,</span>
      <span class="token property">&quot;stencilWriteMask&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>

      <span class="token property">&quot;vertexFields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Position&quot;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;msaaSupport&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Both&quot;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>In the example, StencilWrite represents the support for writing to the mask buffer, EnableStencilTest represents the opening of the mask test, and the configuration of frontFace represents that the mask test always passes when the front face is rendered. If the depth test fails, the buffer value remains unchanged. If it also passes, the stencil bit and the value of stencilWriteMask will be written to the buffer, that is, 1 &amp; 1 = 1 value. The configuration of backFace is also similar.</p><h4 id="blend-translucent-object-color-blend" tabindex="-1">Blend translucent object color blend <a class="header-anchor" href="#blend-translucent-object-color-blend" aria-hidden="true">#</a></h4><p>The rendering of translucent objects needs to configure the blending factor. The final output rgb color value = current color value * source blending factor + color value in buffer * destination blending factor</p><h5 id="blendsrc" tabindex="-1"><code>blendSrc</code> <a class="header-anchor" href="#blendsrc" aria-hidden="true">#</a></h5><p>source mix factor</p><h5 id="blenddst" tabindex="-1"><code>blendDst</code> <a class="header-anchor" href="#blenddst" aria-hidden="true">#</a></h5><p>target blending factor</p><h5 id="alphasrc" tabindex="-1"><code>alphaSrc</code> <a class="header-anchor" href="#alphasrc" aria-hidden="true">#</a></h5><p>The source blending factor when calculating alpha, usually not configured to take the default value</p><h5 id="alphadst" tabindex="-1"><code>alphaDst</code> <a class="header-anchor" href="#alphadst" aria-hidden="true">#</a></h5><p>The target blending factor when calculating alpha, usually not configured to take the default value</p><p>In total, the blending factor can take on the following values:</p><ul><li><p><code>DestColor</code>\uFF1A Buffer color value</p></li><li><p><code>SourceColor</code>\uFF1A Current color value</p></li><li><p><code>Zero</code>\uFF1A (0,0,0)</p></li><li><p><code>One</code>\uFF1A (1,1,1)</p></li><li><p><code>OneMinusDestColor</code>: (1,1,1) - buffer color value</p></li><li><p><code>OneMinusSrcColor</code>: (1,1,1) - current color value</p></li><li><p><code>SourceAlpha</code>\uFF1A The alpha value in the current color</p></li><li><p><code>DestAlpha</code>\uFF1A Alpha value in buffer color</p></li><li><p><code>OneMinusSrcAlpha</code>\uFF1A 1 - alpha value in the current color value</p></li></ul><p>In the engine, the default is:</p><ul><li><p><code>blendSrc</code>\uFF1ASourceAlpha</p></li><li><p><code>blendDst</code>\uFF1AOneMinusSrcAlpha</p></li><li><p><code>alphaSrc</code>\uFF1AOne</p></li><li><p><code>alphaDst</code>\uFF1AOneMinusSrcAlpha</p></li></ul><p>Associated states rendering environment configuration:</p><ul><li><p><code>Blending</code>: Enables color blending mode, often used to render translucent objects. After declaring this, it is usually necessary - to declare the blending factor blendSrc, blendDst</p></li><li><p><code>DisableColorWrite</code>\uFF1A Do not write color values to the color buffer, none of the RGBA channels are written</p></li><li><p><code>DisableAlphaWrite</code>\uFF1A Do not write transparency alpha values to the color buffer, allow RGB values to be written</p></li><li><p><code>DisableRGBWrite</code>\uFF1A Do not write transparency RGB values to the color buffer, allow writing alpha values</p></li></ul><h4 id="sample-texture-sample" tabindex="-1">Sample texture sample <a class="header-anchor" href="#sample-texture-sample" aria-hidden="true">#</a></h4><h5 id="samplerstates" tabindex="-1"><code>samplerStates</code> <a class="header-anchor" href="#samplerstates" aria-hidden="true">#</a></h5><p>Configure the sampling state, the value is a list, and configure each texture according to the number of textures to be sampled. Usually, if UV0 and UV1 are declared in the vertex attribute, it means that two textures need to be sampled, and two elements need to be configured here. Let&#39;s look at the definition of child elements:</p><div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">{</span>
	<span class="token property">&quot;samplerIndex&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">&quot;textureFilter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Point&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;textureWrap&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Repeat&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Each property is defined as follows:</p><h5 id="samplerindex" tabindex="-1"><code>samplerIndex</code> <a class="header-anchor" href="#samplerindex" aria-hidden="true">#</a></h5><p>Number, representing the attribute of the texture that is currently being set, starting from 0</p><h5 id="texturefilter" tabindex="-1"><code>textureFilter</code> <a class="header-anchor" href="#texturefilter" aria-hidden="true">#</a></h5><p>Texture filtering mode (default is Point), when the actual displayed texture map is enlarged or reduced compared to the original image, the mapping relationship between the new resolution map and the pixels on the original resolution map can have the following values:</p><ul><li><p><code>Point</code>\uFF1A Point sampling</p></li><li><p><code>Bilinear</code>: Bilinear sampling</p></li><li><p><code>Trilinear</code>: Trilinear sampling</p></li><li><p><code>MipMapBilinear</code>\uFF1A MipMap bilinear sampling</p></li><li><p><code>TexelAA</code>\uFF1ATexel antialiasing (not supported on all devices, not recommended)</p></li><li><p><code>PCF</code>\uFF1ASampling by comparison function (not supported on all devices, not recommended)</p></li></ul><h5 id="texturewrap" tabindex="-1"><code>textureWrap</code> <a class="header-anchor" href="#texturewrap" aria-hidden="true">#</a></h5><p>Texture wrapping mode, which controls what kind of texture should be sampled when uv is outside [0,1]. It can have the following values:</p><ul><li><p><code>Repeat</code>\uFF1A Repeat, that is, modulo the value to [0, 1] for sampling</p></li><li><p><code>Clamp</code>\uFF1A Edge sampling, sampling the value of the closest edge, that is, if 1.1 is closer to 1, then take 1; if -0.1 is closer to 0, then take 0.</p></li></ul><h4 id="vertex" tabindex="-1">Vertex <a class="header-anchor" href="#vertex" aria-hidden="true">#</a></h4><h5 id="vertexfields" tabindex="-1"><code>vertexFields</code> <a class="header-anchor" href="#vertexfields" aria-hidden="true">#</a></h5><p>Vertex attributes, which are used to declare what attributes each vertex of the mesh that is rendered using this material holds. It is determined when the art is producing resources. The following values \u200B\u200Bmay be used:</p><ul><li><p><code>Position</code>\uFF1A Model space coordinates</p></li><li><p><code>Color</code>\uFF1A Color</p></li><li><p><code>Normal</code>\uFF1A Normal</p></li><li><p><code>UV0</code>: Texture sample coordinates</p></li><li><p><code>UV1</code>\uFF1ATexture sample coordinates</p></li><li><p><code>UV2</code>\uFF1ATexture sample coordinates</p></li><li><p><code>BoneId0</code>\uFF1A Bone ID, used in the bone model</p></li></ul><h4 id="rasterizer-environment-configuration" tabindex="-1">Rasterizer environment configuration <a class="header-anchor" href="#rasterizer-environment-configuration" aria-hidden="true">#</a></h4><h5 id="msaasupport" tabindex="-1"><code>msaaSupport</code> <a class="header-anchor" href="#msaasupport" aria-hidden="true">#</a></h5><p>Configure MSAA (Multi-Sample Anti-Aliasing) support (the default in the engine is NonMSAA)</p><ul><li><p><code>NonMSAA</code>: Materials are allowed when MSAA is not enabled</p></li><li><p><code>MSAA</code>: Materials are allowed when MSAA is enabled</p></li><li><p><code>Both</code>\uFF1AMaterials are allowed with or without MSAA enabled. Usually just use this value.</p></li></ul><h5 id="depth-offset" tabindex="-1"><code>depth offset</code> <a class="header-anchor" href="#depth-offset" aria-hidden="true">#</a></h5><p>Depth offset is mainly used to solve the z-fighting problem, that is, when two objects have similar depths, some frames may display this object and some frames display another object when rendering. The principle of depth offset is to offset one of the objects in the direction of large or small depth, so that their depths are no longer the same. The following four variables can be configured:</p><ul><li><p>depthBias</p></li><li><p>slopeScaledDepthBias</p></li><li><p>depthBiasOGL</p></li><li><p>slopeScaledDepthBiasOGL</p></li></ul><p>The specific offset depth is:</p><p><code>offset = (slopeScaledDepthBias * m) + (depthBias * r)</code></p><p>On the OGL platform it is:</p><p><code>offset = (slopeScaledDepthBiasOGL * m) + (depthBiasOGL * r)</code></p><p>m is the maximum value in the slope of the depth of the polygon (computed at the rasterization stage). The more parallel a polygon is to the near clipping plane, the closer m is to 0. r is the smallest value that produces a discernible difference in depth values \u200B\u200Bin the window coordinate system, and r is a constant specified by the platform that implements OpenGL.</p><p>Associated states rendering environment configuration:</p><ul><li><p><code>Wireframe</code>\uFF1A Draw wireframe mode</p></li><li><p><code>DisableCulling</code>: Render front and back simultaneously</p></li><li><p><code>InvertCulling</code>\uFF1AUse front cropping. The default is back cropping. After declaring this, the back side is rendered and the front - side is cropped.</p></li></ul><h4 id="primitive" tabindex="-1">Primitive <a class="header-anchor" href="#primitive" aria-hidden="true">#</a></h4><h5 id="primitivemode" tabindex="-1"><code>primitiveMode</code> <a class="header-anchor" href="#primitivemode" aria-hidden="true">#</a></h5><p>Primitive rendering mode (the default in the engine is TriangleList):</p><ul><li><p><code>None</code>\uFF1A Do not render, normally not used</p></li><li><p><code>QuadList</code>\uFF1AQuadrilateral pattern</p></li><li><p><code>TriangleList</code>: A pattern of drawing a triangle every three vertices, for example the first triangle uses vertices v0, v1, v2, and the second uses v3, v4, v5</p></li><li><p><code>TriangleStrip</code>: Each vertex will form a triangle with the first two vertices, the structure is a bit more complicated, but it - will save the amount of data</p></li><li><p><code>LineList</code>: Draw a line segment every two vertices</p></li><li><p><code>Line</code>: Each vertex forms a line segment with a vertex that appears before it.</p></li></ul><h3 id="material-variant" tabindex="-1">Material variant <a class="header-anchor" href="#material-variant" aria-hidden="true">#</a></h3><h4 id="variants" tabindex="-1"><code>variants</code> <a class="header-anchor" href="#variants" aria-hidden="true">#</a></h4><p>Useful for quickly implementing multiple sub-materials based on most of the same definitions. See the actual example of entity_static below:</p><div class="language-json line-numbers-mode"><pre><code>    <span class="token property">&quot;entity_static&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;vertexShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/entity.vertex&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;vrGeometryShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/entity.geometry&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fragmentShader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shaders/entity.fragment&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;vertexFields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Position&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Normal&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UV0&quot;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;variants&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;skinning&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;+defines&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;USE_SKINNING&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;vertexFields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Position&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BoneId0&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Normal&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UV0&quot;</span> <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;skinning_color&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;+defines&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;USE_SKINNING&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;USE_OVERLAY&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;+states&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;Blending&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;vertexFields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Position&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BoneId0&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Color&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Normal&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span> <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;UV0&quot;</span> <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;msaaSupport&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Both&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;+samplerStates&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;samplerIndex&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          <span class="token property">&quot;textureFilter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Point&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>Variants are declarations of material variants. The above declarations declare two sub-variants, skinning and skinning_color. Some external fields are rewritten in the sub-variants. In actual use, it is equivalent to quickly defining two materials. The body and the variant are connected with a dot &quot;.&quot;. The two materials are entity_static.skinning and entity_static.skinning_color.</p><p>In addition, if there are other materials that inherit from entity_static, such as entity_dynamic, this material will also inherit these two variants, entity_dynamic.skinning and entity_dynamic.skinning_color.</p><h2 id="material-merge-rules" tabindex="-1">Material Merge Rules <a class="header-anchor" href="#material-merge-rules" aria-hidden="true">#</a></h2><p>When the same material is declared in different directory files, it will be merged according to the following rules after loading: 1. Normally, the material fields of the files loaded later will overwrite the previously loaded ones. 2. The following fields are special. Operations to add attributes with &quot;+&quot; and delete attributes with &quot;-&quot; are supported:</p><ul><li>defines</li><li>states</li><li>samplerStates</li></ul><p>As an example, for example, such a material is declared in the package body file (irrelevant code is omitted), and three macros are defined:</p><div class="language-json line-numbers-mode"><pre><code><span class="token property">&quot;testMat&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;defines&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;MACRO_1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MACRO_2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MACRO_3&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>At this point, a mod also declares this material, defining another three macros:</p><div class="language-json line-numbers-mode"><pre><code><span class="token property">&quot;testMat&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;defines&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;MACRO_4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MACRO_5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MACRO_6&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>In the above case, the final runtime is equivalent to the defines field being overwritten, and the macros that take effect at the actual runtime are only: MACRO_4, MACRO_5, MACRO_6</p><p>If the &quot;+&quot; symbol is used when defining in the MOD:</p><div class="language-json line-numbers-mode"><pre><code><span class="token property">&quot;testMat&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;+defines&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;MACRO_4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MACRO_5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;MACRO_6&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Equivalent to adding definitions on the original basis, the macros that take effect at actual runtime are: MACRO_1, MACRO_2, MACRO_3, MACRO_4, MACRO_5, MACRO_6</p><p>If the &quot;-&quot; symbol is used when defining in the MOD:</p><div class="language-json line-numbers-mode"><pre><code><span class="token property">&quot;testMat&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;-defines&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;MACRO_3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>It is equivalent to deleting some definitions on the original basis, the only macros that take effect at runtime are: MACRO_1, MACRO_2</p><p>If multiple files define the same material, and they involve overlay, add, and delete operations, the order in which they will take effect is: first perform all overlay operations, then perform all add operations, and finally perform all delete operations .</p><p>i.e. if one of the material files declares a delete MACRO_3 action:</p><div class="language-json line-numbers-mode"><pre><code><span class="token property">&quot;testMat&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token property">&quot;-defines&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;MACRO_3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Then no matter how other files are covered, add MACRO_3, and this material must not have MACRO_3 macro after the final synthesis.</p>`,128);function f(q,g,v,y,w,x){const a=r("CodeHeader");return l(),p("div",null,[c,s(a,null,{default:e(()=>[u]),_:1}),d,s(a,null,{default:e(()=>[h]),_:1}),k,s(a,null,{default:e(()=>[m]),_:1}),b])}var A=o(i,[["render",f]]);export{S as __pageData,A as default};
